---
layout: post
title: "AnoDDPM: Anomaly Detection with Denoising Diffusion Probabilistic Models using Simplex Noise"
subtitle: ""
date: 2025-08-25
author: "Can"
header-img: "img/sailboat.jpg"
tags: ["Paper-Reading", "Anomaly-Detection", "CVPRW", "DDPM", "Diffusion-Model"]
---

论文链接：[Paper](https://openaccess.thecvf.com/content/CVPR2022W/NTIRE/papers/Wyatt_AnoDDPM_Anomaly_Detection_With_Denoising_Diffusion_Probabilistic_Models_Using_Simplex_CVPRW_2022_paper.pdf)

代码链接：[Code](https://github.com/Julian-Wyatt/AnoDDPM)

**这篇论文来源是CVPR Workshop 2022，真实性有待检验，但其使用Simplex Noise替换Gaussian Noise以提高DDPM进行异常检测性能的方法还是很有参考意义的。**

## Background
* 生成模型已被证明可以通过建模正常数据来提供强大的异常检测机制，这些数据随后可以用作异常评分的基线。
* DDPMs在样本质量和模式覆盖方面已经成为生成建模的最新方法，能够从复杂的数据分布中生成样本，相比于生成对抗网络(GAN)和变分自编码器(VAEs)相比具有更好的模式覆盖。

## Motivation
尽管DDPMs在模式覆盖上优于生成对抗网络（GANs）和变分自编码器（VAEs），但它们在可扩展性和采样时间上存在不足，因为需要长马尔可夫链序列而且高斯扩散无法捕获更大的异常。 

**提出了部分扩散异常检测模型 AnoDDPM**
它存在以下优点：
* 部分扩散允许从数据分布和尺度上更好地重建样本到高分辨率图像。
* 使用多尺度单纯形噪声扩散过程来控制目标异常的大小。
* 更短的马尔可夫链加快模型训练和推理的速度。

## Method
### DDPM Model
![DDPM Model](\img\in-post\image-pjgz.png)
![DDPM Function](\img\in-post\image-thlp.png)
![DDPM Visualization](\img\in-post\image-pczb.png)
**DDPM模型实际上就是一个Forward Diffusion Process（前向扩散加噪）和Reverse Denoising Process（反向扩散去噪）的过程。**
### Comparison of Simple Noise and Gaussian Noise
![comparison](\img\in-post\image-ajku.png)
由上到下第五行是使用Simplex Noise进行DDPM生成图片的过程，可以看到最终得到了健康近似的结果（由于DDPM在训练阶段没有见过异常信息，所以DDPM会按照自己所学习到的正常数据模式进行生成）。
### Features of Simple Noise
![features](\img\in-post\image-jvvx.png)
simple noise相对于标准高斯扰动的潜在好处是损坏更结构化和去噪过程将能够修复结构化异常。
### Training Algorithm
![training](\img\in-post\image-tqym.png)
### Inference Algorithm
![inference](\img\in-post\image-bkku.png)

## Experiment
### Datasets
* Neurofeedback Skull-Stripped (NFBS) repository,包含125个T1加权MRI扫描（每一套数据包括完整颅骨图像，去颅骨MR图像，大脑分割结果）
* 爱丁堡大学临床脑科学中心提供的包含22个T1加权MRI扫描数据集
* MVTec AD的leather subset

### Evaluation Metrics
* AUROC(Receiver Operating Characteristic Curve)

### Results
![results](\img\in-post\image-clhf.png)
可以看到即使是在工业缺陷异常检测数据集MVTec-AD中，AnoDDPM也有不错的效果。
![results](\img\in-post\image-pxkz.png)
![results](\img\in-post\image-pzlq.png)
![results](\img\in-post\image-lnoq.png)
可以看到使用Simplex Noise的DDPM模型性能最佳。

## Conclusion
* AnoDDPM通过使用单纯形噪声和部分扩散策略，成功地在不需要大型数据集的情况下捕获了大型异常区域，并避免了基于GAN的方法中常见的局限性。
* 该方法在医疗和非医疗应用中捕获更大的异常形状方面提供了显著的改进，有望在其他领域如自动威胁检测和假冒产品检测中发挥作用。
* 部分扩散策略确保该方法在高分辨率图像中保持高性能，可推广于全长马尔可夫链的应用，比如图像增强、语义分割和过滤。